---
title: ln
layout: page
date: 2015-11-24
---
[TOC]

## 命令说明

指令名称 : ln

使用权限 : 所有使用者

使用方式 : `ln [options] source dist`，其中 option 的格式为 :
`[-bdfinsvF] [-S backup-suffix] [-V {numbered,existing,simple}] [--help] [--version] [--]`

说明 : Linux/Unix 档案系统中，有所谓的链接(link)，我们可以将其视为档案的别名，而链接又可分为两种 : 硬链接(hard link)与软链接(symbolic link)，硬链接的意思是一个档案可以有多个名称，而软链接的方式则是产生一个特殊的档案，该档案的内容是指向另一个档案的位置。硬链接是存在同一个档案系统中，而软链接却可以跨越不同的档案系统。

`ln source dist` 是产生一个链接(dist)到 source，至于使用硬链接或软链接则由参数决定。

不论是硬链接或软链接都不会将原本的档案复制一份，只会占用非常少量的磁碟空间。

    -f : 链接时先将与 dist 同档名的档案删除
    -d : 允许系统管理者硬链接自己的目录
    -i : 在删除与 dist 同档名的档案时先进行询问
    -n : 在进行软链接时，将 dist 视为一般的档案
    -s : 进行软链接(symbolic link)
    -v : 在链接之前显示其档名
    -b : 将在链接时会被覆写或删除的档案进行备份
    -S SUFFIX : 将备份的档案都加上 SUFFIX 的字尾
    -V METHOD : 指定备份的方式
    --help : 显示辅助说明
    --version : 显示版本

## 注意事项

- > linux系统中的硬链接有两个限制：不能跨越文件系统和不允许普通用户对目录作硬链接。至于第一个限制，很好理解，而第二个就不那么好理解了。 我们对任何一个目录用ls -l 命令都可以看到其链接数至少是2，这也说明了系统中是存在硬链接的，而且命令ln -d 也可以让超级用户对目录作硬链接，这些都说明了系统限制对目录进行硬链接只是一个硬性规定，并不是逻辑上不允许或技术上的不可行。那么操作系统为什么要进行限制呢？
如果引入了对目录的硬链接就有可能在目录中引入循环，那么在目录遍历的时候系统就会陷入无限循环当中。也许您会说，符号链接不也可以引入循环吗，那么为什么不限制目录的符号链接呢？原因就在于在linux系统中，每个文件(目录也是文件)都对应着一个inode结构，其中inode数据结构中包含了文件类型(目录，普通文件，符号链接文件等等)的信息，也就是说操作系统在遍历目录时可以判断出符号链接，既然可以判断出符号链接当然就可以采取一些措施来防范进入过大的循环了，系统在连续遇到8个符号链接后就停止遍历，这就是为什么对目录符号链接不会进入死循环的原因了。但是对于硬链接，由于操作系统中采用的数据结构和算法限制，目前是不能防范这种死循环的。

- `-n` 的用途:在软链接目录的时候,如果你链接过去的目录已经存在的话,就会在产生目录嵌套的问题.`-n` 会将目录视为文件,这样子就避免目录嵌套.
- `ln source dest` 中的 `source` 最好写成绝对路径.
